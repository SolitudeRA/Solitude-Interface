---
import PostHeader from './PostHeader.astro';
import TableOfContents from './TableOfContents.tsx';
import type { PostTag } from '@api/ghost/types';

interface Props {
    title: string;
    feature_image: URL;
    primary_tag?: PostTag | undefined;
    tags?: PostTag[] | undefined;
    published_at: string;
    html: string;
}

const { title, feature_image, primary_tag, tags, published_at, html } =
    Astro.props;
const featureImageUrl = feature_image?.toString() || '';
---

<div class="solitude-article-container grid grid-cols-12">
    <!-- 左侧 TOC 区域 -->
    <div class="solitude-article-rail col-span-2 flex">
        <div class="toc-wrapper w-full">
            <TableOfContents client:idle />
        </div>
    </div>
    
    <!-- 中间文章主体 -->
    <div class="solitude-article-body col-span-8 pb-[200px]">
        <div class="solitude-article-meta">
            <PostHeader
                title={title}
                primary_tag={primary_tag}
                tags={tags}
                published_at={published_at}
            />
        </div>
        <div>
            <div class="solitude-article-content" set:html={html} />
        </div>
    </div>
    
    <!-- 右侧空白区域 -->
    <div class="solitude-article-rail col-span-2"></div>
</div>

<style define:vars={{ featureImageUrl: featureImageUrl ? `url(${featureImageUrl})` : 'none' }}>
    .solitude-article-meta {
        background-size: cover;
        background-position: center;
        background-image: var(--featureImageUrl);
        border-radius: 0 0 24px 24px;
        margin-bottom: 2rem;
    }
</style>
