---
import type { Post } from '@api/ghost/types';
import { Chip } from '@components/common/badge';

interface Props {
    post: Post;
}

const { post } = Astro.props;
const postFeatureImageLightUrl = `linear-gradient(rgba(255, 255, 255, 0.45), rgba(255, 255, 255, 0.45)),url(${post.feature_image.toString()})`;
const postFeatureImageDarkUrl = `linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)),url(${post.feature_image.toString()})`;
---

<div class="post-view-card-video h-full w-full rounded-[35px] p-6 shadow-lg transition-all duration-300 hover:shadow-2xl flex flex-col">
    <!-- é¡¶éƒ¨æ ‡ç­¾åŒº -->
    <div class="flex items-center justify-between mb-4">
        <Chip variant="flat" colorScheme="primary" client:visible>
            ðŸŽ¬ {post.post_type}
        </Chip>
        {post.post_series && (
            <Chip variant="flat" colorScheme="secondary" client:visible>
                {post.post_series}
            </Chip>
        )}
    </div>

    <!-- æ’­æ”¾æŒ‰é’®åŒº -->
    <div class="flex items-center justify-center py-6">
        <div class="play-button flex h-20 w-20 items-center justify-center rounded-full bg-white/30 backdrop-blur-sm transition-all duration-300 hover:scale-110 hover:bg-white/50 dark:bg-black/30 dark:hover:bg-black/50">
            <span class="text-4xl">â–¶</span>
        </div>
    </div>

    <!-- æ ‡é¢˜åŒº -->
    <div class="mb-4">
        <h3 class="text-2xl font-bold leading-tight line-clamp-3 text-center">
            {post.title}
        </h3>
    </div>

    <!-- æ‘˜è¦åŒºï¼ˆflex-1 å æ®å‰©ä½™ç©ºé—´ï¼‰ -->
    <div class="flex-1 overflow-hidden mb-4">
        <p class="text-base leading-relaxed line-clamp-[6] opacity-90">
            {post.excerpt}
        </p>
    </div>

    <!-- åº•éƒ¨ä¿¡æ¯åŒº -->
    <div class="mt-auto space-y-3">
        <div class="text-center text-sm opacity-75">
            {post.published_at.split('T')[0]}
        </div>
        {post.post_general_tags && post.post_general_tags.length > 0 && (
            <div class="flex flex-wrap gap-2 justify-center">
                {post.post_general_tags.slice(0, 4).map((tagName: string) => (
                    <Chip colorScheme="success" variant="flat" client:visible>
                        {tagName}
                    </Chip>
                ))}
            </div>
        )}
    </div>
</div>

<style
    define:vars={{
        postFeatureImageLightUrl: postFeatureImageLightUrl,
        postFeatureImageDarkUrl: postFeatureImageDarkUrl,
    }}
>
    .post-view-card-video {
        background-size: cover;
        background-position: center;
        background-image: var(--postFeatureImageLightUrl);
    }

    .dark .post-view-card-video {
        background-image: var(--postFeatureImageDarkUrl);
    }
</style>
