---
import type { Post } from '@api/ghost/types';
import { Chip } from '@components/common/badge';

interface Props {
    post: Post;
}

const { post } = Astro.props;
const postFeatureImageLightUrl = `linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)),url(${post.feature_image.toString()})`;
const postFeatureImageDarkUrl = `linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)),url(${post.feature_image.toString()})`;
---

<div
    class="post-view-card-article flex h-full w-full flex-col rounded-[35px] p-6 shadow-lg transition-all duration-300 hover:shadow-2xl"
>
    <!-- È°∂ÈÉ®Ê†áÁ≠æÂå∫ -->
    <div class="mb-4 flex items-center justify-between">
        <Chip variant="flat" colorScheme="primary" client:visible>
            üìù {post.post_type}
        </Chip>
        {
            post.post_series && (
                <Chip variant="flat" colorScheme="secondary" client:visible>
                    {post.post_series}
                </Chip>
            )
        }
    </div>

    <!-- Ê†áÈ¢òÂå∫ -->
    <div class="mb-4">
        <h3 class="line-clamp-3 text-center text-2xl leading-tight font-bold">
            {post.title}
        </h3>
    </div>

    <!-- ÊëòË¶ÅÂå∫Ôºàflex-1 Âç†ÊçÆÂâ©‰ΩôÁ©∫Èó¥Ôºâ -->
    <div class="mb-4 flex-1 overflow-hidden">
        <p class="line-clamp-[8] text-base leading-relaxed opacity-90">
            {post.excerpt}
        </p>
    </div>

    <!-- Â∫ïÈÉ®‰ø°ÊÅØÂå∫ -->
    <div class="mt-auto space-y-3">
        <div class="text-center text-sm opacity-75">
            {post.published_at.split('T')[0]}
        </div>
        {
            post.post_general_tags && post.post_general_tags.length > 0 && (
                <div class="flex flex-wrap justify-center gap-2">
                    {post.post_general_tags
                        .slice(0, 4)
                        .map((tagName: string) => (
                            <Chip
                                colorScheme="success"
                                variant="flat"
                                client:visible
                            >
                                {tagName}
                            </Chip>
                        ))}
                </div>
            )
        }
    </div>
</div>

<style
    define:vars={{
        postFeatureImageLightUrl: postFeatureImageLightUrl,
        postFeatureImageDarkUrl: postFeatureImageDarkUrl,
    }}
>
    .post-view-card-article {
        background-size: cover;
        background-position: center;
        background-image: var(--postFeatureImageLightUrl);
    }

    .dark .post-view-card-article {
        background-image: var(--postFeatureImageDarkUrl);
    }
</style>
